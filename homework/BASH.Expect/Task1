# Напишите скрипт для автоматизации подключения по ssh
# Имя хоста передается скрипту как аргумент командной строки
# Пароль отсылается самостоятельно

#!/usr/bin/expect

# Проверяем наличие аргументов
if {$argc < 1} {
    send_user "Использование: $argv0 <hostname>\n"
    exit 1
}

# Получаем имя хоста из аргументов командной строки
set hostname [lindex $argv 0]

# Вводим пароль в интерактивном режиме
spawn ssh $hostname

# Ожидаем приглашение ввода пароля
expect "password:"

# Вводим пароль
send "ВАШ_ПАРОЛ\n"

# Ожидаем подключения
expect {
    "Permission denied" {
        send_user "Ошибка: Неверный пароль или проблемы с аутентификацией.\n"
        exit 1
    }
    "Last login" {
        send_user "Подключение к $hostname успешно!\n"
        interact
    }
    timeout {
        send_user "Ошибка: Время ожидания истекло.\n"
        exit 1
    }
}

exit 0
